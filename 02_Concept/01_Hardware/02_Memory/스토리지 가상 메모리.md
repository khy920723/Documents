# 스토리지 가상 메모리
# 📚 가상 메모리(Virtual Memory) 총정리

## ✅ 1. 개념 정의

| 항목    | 설명                                                         |
| ----- | ---------------------------------------------------------- |
| 정의    | **물리 메모리(RAM)의 용량을 초과한 메모리를 사용할 수 있게 해주는 OS 기능**.          |
| 역할    | 하드디스크(또는 SSD)의 일부 공간을 RAM처럼 사용하여, 프로그램이 큰 메모리를 사용할 수 있게 함. |
| 핵심 기술 | **페이지(page)** 단위의 **메모리 매핑**, **페이지 교체 알고리즘** 등            |
| 구현 위치 | CPU (MMU: Memory Management Unit), OS 커널, 스토리지 드라이버        |
## ✅ 2. 왜 필요한가?

| 이유              | 설명                                               |
| --------------- | ------------------------------------------------ |
| **메모리 부족 해결**   | 물리 RAM이 부족해도 여러 프로그램을 동시에 실행할 수 있음.              |
| **보안/안정성 향상**   | 각 프로세스에 **독립적인 주소 공간 제공 → 메모리 침범 방지**            |
| **프로세스 격리**     | 각 프로세스는 0x00000000부터 시작하는 것처럼 보임 (논리 공간 제공)      |
| **큰 메모리 사용 가능** | RAM 8GB인 시스템도, 가상 메모리로 총 16GB 이상 사용 가능하게 보이도록 제공 |
## ✅ 3. 동작 원리 (하드웨어 + OS 관점)

### 📌 개념 흐름

1. **프로세스 실행** → OS는 **논리 주소(virtual address)** 공간을 부여.    
2. 논리 주소는 실제 RAM의 **물리 주소(physical address)** 로 **MMU**가 변환함.
3. RAM이 부족하면 OS가 SSD 등 저장장치 일부를 **"스왑 공간(Swap space)"** 으로 사용.
4. 현재 필요 없는 메모리 페이지를 **디스크로 저장(페이지 아웃)** → RAM 확보
5. 나중에 해당 데이터가 다시 필요해지면 **디스크에서 다시 RAM으로 로드(페이지 인)**
## ✅ 4. 가상 메모리 관련 용어 정리

| 용어                         | 설명                                                                               |
| -------------------------- | -------------------------------------------------------------------------------- |
| **MMU**                    | Memory Management Unit. 논리 주소 → 물리 주소로 매핑해주는 하드웨어                                |
| **Page / Frame**           | 메모리를 일정 크기(보통 4KB)로 나눈 단위                                                        |
| **Page Table**             | 가상 페이지 ↔ 실제 물리 프레임 간 매핑 정보를 담은 구조체                                               |
| **Page Fault**             | 접근한 페이지가 RAM에 없을 경우 발생. → 디스크에서 가져와야 함                                           |
| **Swap Space / Swap File** | 디스크 상의 영역. RAM처럼 쓰기 위한 공간. Windows는 `pagefile.sys`, Linux는 `/swap`, macOS는 자동 관리 |
## ✅ 5. 가상 메모리와 SSD의 관계

| 항목            | 설명                                                     |
| ------------- | ------------------------------------------------------ |
| 기본 원리         | SSD(또는 HDD)를 **RAM 부족 시 대체 메모리처럼 사용**                  |
| SSD의 장점       | HDD보다 빠르므로 **스왑 공간 사용 시 성능 저하가 덜함**                    |
| SSD 사용 시 고려사항 | 잦은 스왑 → **쓰기 수명 감소 가능** (SSD는 쓰기 횟수 제한 있음)             |
| 고급 설정 예       | Linux: `swappiness`, Windows: "가상 메모리 자동 관리 끄고 사용자 지정" |
## ✅ 6. 가상 메모리 vs 물리 메모리(RAM) 차이점

| 항목    | RAM                 | 가상 메모리 (SSD 등)               |
| ----- | ------------------- | ---------------------------- |
| 속도    | 매우 빠름 (10~100ns)    | 느림 (SSD 기준 100μs, HDD는 수 ms) |
| 위치    | 물리적 메모리 칩           | 디스크 (SSD, HDD)               |
| 용량    | 제한됨 (8GB, 16GB 등)   | 상대적으로 큼 (수십 GB 이상 설정 가능)     |
| 사용 목적 | 프로그램 실행의 **핵심** 메모리 | RAM이 부족할 때 **보조 수단**         |
| 전력 소비 | 낮음                  | SSD는 조금 더 높고, HDD는 더 높음      |
| 수명 영향 | 없음                  | SSD는 스왑 과다 시 수명 단축 가능        |
## ✅ 7. 실제 사용 예시

| 상황                            | 가상 메모리 활용 방식              |
| ----------------------------- | ------------------------- |
| **포토샵, 블렌더 등 메모리 많이 쓰는 앱 실행** | 필요한 만큼만 RAM에 올리고, 나머지는 스왑 |
| **브라우저 탭을 여러 개 열었을 때**        | 안 보는 탭은 스왑 공간으로 이동        |
| **Docker / 가상 머신 실행 시**       | 게스트 OS의 메모리를 스왑으로 해결      |
| **게임 플레이 중 백그라운드 앱 다수**       | 우선순위 낮은 앱은 디스크로 내려감       |
## ✅ 8. 성능 측면 비교 및 효율성 분석

| 조건    | RAM      | 가상 메모리          |
| ----- | -------- | --------------- |
| 속도    | 매우 빠름    | 느림 (최소 100배 느림) |
| 반응성   | 즉시 응답    | 딜레이 발생 가능       |
| 다중 작업 | 빠름       | 많은 스왑 시 느려짐     |
| 효율    | 고성능 유지   | RAM 부족 시 생존성 유지 |
| 비용    | 상대적으로 고가 | 디스크 공간이 더 저렴    |

> ✅ **현실적인 결론**:
> 
> - **RAM은 성능을 위한 필수 자원**
>     
> - **가상 메모리는 "RAM이 부족할 때의 대안"이며, 절대 주 메모리를 대체하진 못함**
>     
## ✅ 9. OS별 가상 메모리 특징

| OS          | 가상 메모리 관리 방식                                | 커스터마이징                                         |
| ----------- | ------------------------------------------- | ---------------------------------------------- |
| **Windows** | `pagefile.sys`로 스왑 관리                       | 크기 자동/수동 설정 가능                                 |
| **macOS**   | 자동으로 스왑 파일 생성 (`/private/var/vm/swapfile*`) | 사용자가 직접 설정 불가                                  |
| **Linux**   | `/swap` 파티션 또는 `swapfile` 사용                | `swappiness`, `vm.overcommit_memory` 등으로 조정 가능 |
## ✅ 10. 고급 정보 (실무용 팁)

### 📌 swappiness (Linux 전용)
- `vm.swappiness`: RAM이 얼마나 차야 스왑을 사용할지 결정 (0~100)
    - 0: 거의 스왑 안 함
    - 100: 적극적으로 스왑 사용
- 설정 예:
    ```bash
    sysctl vm.swappiness=10
    ```

### 📌 SSD에서 스왑 성능 최적화
- 스왑 공간을 SSD에서 분리된 별도 파티션에 두는 것이 유리함
- `zram`(압축된 메모리) 사용도 가능 → RAM을 압축해서 더 오래 버팀
# 🔚 요약

| 핵심 포인트  | 설명                                      |
| ------- | --------------------------------------- |
| 가상 메모리란 | SSD/HDD를 RAM처럼 사용하여 메모리 한계를 극복하는 기술     |
| 어떻게 동작? | 논리 주소 ↔ 물리 주소 변환, 부족 시 페이지 단위로 스왑       |
| SSD의 역할 | HDD보다 빠른 디스크 → 스왑 공간으로 더 적합             |
| RAM과 차이 | 속도·구조·목적 모두 다름. RAM은 실사용, SSD는 보조       |
| 실제 사례   | 포토샵, 브라우저, 가상 머신, 멀티태스킹 상황 등에서 매우 중요    |
| OS별 특성  | mac은 자동, 윈도우는 사용자 지정 가능, 리눅스는 세밀한 튜닝 가능 |
